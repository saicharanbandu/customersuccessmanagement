{% extends "base.html" %}

{% load static %}

{% block head_title %}{{ title }}{% endblock %}

{% block navbar %}
{% include '_partials/_navbar.html' %}
{% endblock %}

{% block sidebar %}
{% include '_partials/_sidebar.html' %}
{% endblock %}

{% block page_title %}
<span class="page-title-icon bg-gradient-primary text-white me-2">
    <i class="mdi mdi-bullseye"></i>
</span>
{{ title }}
{% endblock %}

{% block breadcrumbs %}
<ul class="breadcrumb">
    <li class="breadcrumb-item active" aria-current="page">
        <span></span>Overview <i class="mdi mdi-alert-circle-outline icon-sm text-primary align-middle"></i>
    </li>
</ul>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-8 col-lg-6">
              <form method="GET">
                <div class="input-group">
                  <input type="search" class="form-control" placeholder="Search" name="search" value="{{ request.GET.search }}">
                  <button type="submit" class="btn btn-sm btn-light">
                      <i class="mdi mdi-magnify"></i>
                  </button>
                </div>
              </form>
            </div>
            <div class="col-4 col-lg-6">
              <a href="{% url 'prospect:create' %}" class="btn btn-gradient-primary float-end">
                <i class="mdi mdi-plus me-2"></i>
                New Prospect
              </a>
            </div>
          </div>
          <table class="table table-hover mt-3">
            <thead>
              <tr>
                <th>NAME</th>
                <th>LOCATION</th>
                <th>CONTACT PERSONS</th>
                <th>STATUS</th>
                <th>CRM</th>
                <th>REMARKS</th>
                <th class="text-center">ACTIONS</th>
              </tr>
            </thead>
            <tbody>
            {% for prospect in prospects %}
              <tr>
                <td>
                    {{ prospect.name }}
                </td>
                <td>{{ prospect.street}}, <br> {{ prospect.city }}, {{ prospect.misc.state }} {{ prospect.misc.country }}</td>
                <td>
                  {% for contact in contact_persons %}
                  <div class="contact-group">
                    <div>
                      <i class="mdi mdi-email-outline"></i>{{ contact.email }}
                    </div>
                    <div>
                      <i class="mdi mdi-cellphone-android"></i>(+91) {{ contact.mobile_number }}
                    </div>
                  </div>
                  {% endfor %}
                </td>
                <td></td>
                <td>{{ prospect.name }}</td>
                <td>
                    <a href="" data-bs-toggle="tooltip" data-bs-placement="top" title="{{ prospect.remarks }}sdasd">
                    <i class="mdi mdi-information-outline fs-4"></i>
                    </a>
                </td>
                <td class="text-center">
                    <div class="dropdown">
                        <button class="btn p-0" type="button" id="dropdownMenuButton"
                            data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="mdi mdi-dots-vertical"></i>
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="#">
                                <i class="mdi mdi-pencil-box-outline me-2"></i>
                                Edit info
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="mdi mdi-information-outline me-2"></i>
                                Update remarks
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="mdi mdi-account-convert me-2"></i>
                                Re-assign CRM
                            </a>
                            
                            <a class="dropdown-item border-top" href="#">
                                <i class="mdi mdi-refresh me-2"></i>
                                Change status
                            </a>
                        </div>
                    </div>
                </td>
                
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% include '_partials/_pagination.html' %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}